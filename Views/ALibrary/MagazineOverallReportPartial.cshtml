@model IEnumerable<AsteriskBrowserAL.Models.MagazineDetailsData>

<section class="content-header">
    <ol class="breadcrumb">
        <li>
            <i class="menu-icon fa fa-list"></i>
            Academics
        </li>
        <li>
            <i class=""></i>
            Library
        </li>
        <li class="active">Magazine Issued Report</li>
    </ol>
    <!-- /section:basics/content.breadcrumbs -->
</section>
<br />


@if (Model != null)
{
    if (Model.Count() > 0)
    {
        <div class="hr hr-18 dotted hr-double"></div>
        int nsno = 1;
        <div class="table-header">
            Magazine Issued Report
            <button id="Generate" onclick="PrintElem('#mydiv')" class="btn btn-info btn-xs" style="float:right">
                <i class="ace-icon fa fa-print bigger-180"></i>
            </button>
        </div>
        <table id="mytab1" class="table table-hover table-bordered table-striped nowrap dynamic-table" style="font-size:14px;">
            <thead>
                <tr>
                    <th>
                        @Html.DisplayName("SNo")
                    </th>
                    <th>
                        @Html.DisplayName("Accession Number")
                    </th>
                    <th>
                        @Html.DisplayName("Magazine Name")
                    </th>
                    <th>
                        @Html.DisplayName("Publication")
                    </th>
                    <th>
                        @Html.DisplayName("Periodicity Name")
                    </th>
                    @*<th>
                        @Html.DisplayName("Edition")
                    </th>*@
                    <th>
                        @Html.DisplayName("Magazine Issue Date")
                    </th>
                    <th>
                        @Html.DisplayName("User Category")
                    </th>
                    <th>
                        @Html.DisplayName("Magazine Issued To")
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)

                    {
                    <tr>
                        <td>
                            @(nsno++)
                        </td>
                        <td>
                            @item.MagazineCode
                        </td>
                        <td>
                            @item.MagazineName
                        </td>
                        <td>
                            @item.Publisher
                        </td>
                        <td>
                            @item.PeriodicityName
                        </td>
                        @*<td>
                            @item.Edition
                        </td>*@
                        <td>
                            @if (item.IssueDate.HasValue)
                            {
                                @item.IssueDate.Value.ToString("dd -MMM - yyyy")
                            }
                        </td>
                        <td>
                            @item.UserCategory
                        </td>
                        <td>
                            @item.magazineIssuedTo
                        </td>
                    </tr>

                }
                <input type="hidden" id="nMagazineCategoryId" name="MagazineCategoryId" value="@Model.FirstOrDefault().MagazineCategoryId" />
            </tbody>
        </table>

    }
    else
    {
        <span style="color: red;"><b>No records to display</b></span>
    }
}

<script>
    $('#Generate').click(function () {
        debugger
        var MagazineCategoryId = $('#MagazineCategoryId').val()
        debugger
        $('#imagemodal').show();
        $.ajax({
            url: '/ALibrary/MagazineOverallReaportPrint',
            data: { nMagazineCategoryId: MagazineCategoryId },
            success: function (data) {
                $('#table').html(data);
                PrintData(data);
            }
        }).done(function (data) {
            $('#imagemodal').hide();
        });
    })

    function PrintData(data) {
        debugger
        var mywindow = window.open('', 'my div', 'height=300,width=600');
        mywindow.document.write('<p></p>');
        mywindow.document.write(data);
        mywindow.document.write('<p></p>');

        mywindow.document.close();
        mywindow.focus();

        mywindow.print();
        mywindow.close();
        return false;
    }
</script>

@Html.Action("DataTableScripts", "Base")
