@model IEnumerable<AsteriskBrowserAL.Models.ReturnBookViewModel>

<div class="row">
    <div class="col-xs-12">
        @if (null != Model)
            {
                int Sno = 1;
            <div class="table-header">
                Returned Books Details
                <div style="float:right;">
                    <button class="btn btn-info btn-xs" id="ExcelExport">
                        <i class="ace-icon fa fa-share bigger-180"></i>
                    </button>
                </div>
            </div>
            <div style="overflow:auto">
                <table id="Report" class="table table-hover table-bordered table-striped nowrap" style="font-size:14px;">
                    <thead>
                        <tr>
                            <th>
                               S.No.
                            </th>
                            <th>
                                @Html.DisplayName("Book Issued To")
                            </th>
                            <th>
                                @Html.DisplayName("Accession Number")
                            </th>
                            <th>
                                @Html.DisplayName("Book Name")
                            </th>
                            <th>
                                @Html.DisplayName("Publication")
                            </th>
                            <th>
                                @Html.DisplayName("Location")
                            </th>
                            <th>
                                @Html.DisplayName("Book Cost")
                            </th>
                            <th>
                                @Html.DisplayName("Issue Date")
                            </th>
                            <th>
                                @Html.DisplayName("Return Date")
                            </th>
                            <th>
                                @Html.DisplayName("Returned Date")
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.Count() > 0)
                        {
                            int SNo = 1;
                            foreach (var item in Model)
                            {
                                <tr>
                                    <td>
                                        @SNo
                                    </td>
                                    <td>
                                        @item.IssuedToName
                                    </td>
                                    <td>
                                        @item.BookCode
                                    </td>
                                    <td>
                                        @item.BookName
                                    </td>
                                    <td>
                                        @item.PublicationName
                                    </td>
                                    <td>
                                        @item.BooklocationName
                                    </td>
                                    <td>
                                        @item.BookPrice
                                    </td>
                                    <td>
                                        @item.IssueDate.ToShortDateString()
                                    </td>
                                    <td>
                                        @item.ReturnDate.ToShortDateString()
                                    </td>
                                    <td>
                                        @item.BookReturnedDate.ToShortDateString()
                                    </td>
                                </tr>
                                SNo++;
                            }
                        }
                        else
                        {
                            <tr>
                                <td colspan="10">
                                    <span style="color: red;"><b>Data is not available</b></span>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
    </div>
</div>


<script>

    $("#ExcelExport").click(function () {
        debugger
        ExportToExcel('Report');
    });

    function ExportToExcel(tableid) {
        debugger
        var tab_text = "<table border='2px'><tr bgcolor='#87AFC6'>";
        var textRange; var j = 0;
        tab = document.getElementById(tableid); // id of table

        for (j = 0 ; j < tab.rows.length ; j++) {
            tab_text = tab_text + tab.rows[j].innerHTML + "</tr>";
        }

        var a = document.createElement('a');
        a.id = 'tempLink';
        a.href = 'data:application/vnd.ms-excel,' + encodeURIComponent(tab_text);
        a.download = "Book_Issue_Report.xls";
        document.body.appendChild(a);
        a.click();
        document.getElementById('tempLink').remove();
    }
</script>