@model AsteriskBrowserAL.Models.StudentDetailsData
@{
    ViewBag.Title = "Progress Card";

    int nSubId = AsteriskBrowserAL.Helpers.Utility.GetLoggedSubscriptiond();
}
@section BreadCrumb{

    <ul class="breadcrumb">
        <li>
            <i class="menu-icon fa fa-graduation-cap"></i>
            Academics
        </li>
        <li>
            <i class=""></i>
            Front Office
        </li>
        <li class="active">Staff Photo</li>
    </ul><!-- /.breadcrumb -->
}

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/select2/3.5.0/select2.min.css" />

<!-- CSS to make Select2 fit in with Bootstrap 3.x -->
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/select2/3.5.0/select2-bootstrap.min.css" />

<!-- Include Select2 JS -->
<script src="//cdnjs.cloudflare.com/ajax/libs/select2/3.5.0/select2.min.js"></script>


<link href="~/assets/css/jquery-ui.custom.min.css" rel="stylesheet" />
<script src="~/assets/js/jquery-ui.min.js"></script>

<style>
    .ui-autocomplete {
        font-size: 12px;
        cursor: pointer;
        width: 120px;
        height: 120px;
        overflow-y: scroll;
    }
    .form-control.select2-container {
        height: auto !important;
        padding: 0;
        max-width: 200px;
        width: 200px;
    }

    .required:first-letter {
        color: red;
        font-weight: bold;
    }

    .select2-container--default .select2-selection--multiple .select2-selection__rendered {
        box-sizing: border-box;
        list-style: none;
        margin: 0;
        padding: 0 5px;
        width: 100%;
    }

    .select2-container .select2-selection--multiple .select2-selection__rendered {
        display: inline-block;
        overflow: hidden;
        padding-left: 8px;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
</style>



<section class="content">
   
    <div class="row">
        <div class="col-xs-12">
            @using (Html.BeginForm("CaptureStudent", "AFrontOffice", FormMethod.Post))
            {
                    if (null != TempData["Status"])
                    {
                        
                        <p align="center">
                            <span class="savedinfo">



                                <span class=" fa fa-check-circle bigger-260" align="center"></span>
                                <br />
                                <span id="Validation" style="font-weight:bold">@Html.Raw(TempData["Status"])</span>



                                <br />

                                <a href="" class="cls1 btncustom">Close</a>
                                <script>

                                    $(document).ready(function () {
                                        $(".cls1").click(function () {

                                            $(".savedinfo").css("display", "none")
                                        });



                                </script>
                            </span>
                        </p>

                }
                else if (null != TempData["Error"])
                {
                        <span id="Validation" style="color:red;font-weight:bold">@Html.Raw(TempData["Error"])</span>



                    }
                    else
                    {
                        <span id="Validation"></span>
                    }

                    <marquee> <span style="color:orangered;font-weight:bold;font-size:14px">Please use mozilla firefox for capturing photos.</span> </marquee>
                    
                    <input type="hidden" id="BranchId" name="BranchId" value="@nSubId" />
                    <div class="table-header">
                       Capture Staff Photo
                    </div>
                     <div class="widget-box">

                    

                        <div class="widget-body">
                            <div class="widget-main">

                                <div class="row">
                                    <div class="col-xs-12">
                                        <div class="col-xs-6">
                                            <label class="col-xs-4">Staff</label>
                                            <div class="col-xs-6">
                                                <select id="StaffId" name="StaffId" class="form-control select2"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>
                    </div>

                    <div id="Capture"></div>

            }
        </div>
    </div>
</section>

<script>

    var StudentId = "";

    $(document).ready(function () {
            LoadStaff();
    });

    $('input:radio').change(function () {
        $('#Capture').html("");
        CapturePhoto()
    });

    function LoadStaff() {
        var BranchId = $('#BranchId').val();

        if (BranchId > 0) {
            $.ajax({

                url: '/AFrontOffice/GetStaffBySubId',
                data: { nSubId: BranchId },
                success: function (data) {

                    var StaffItems = $('#StaffId');

                    StaffItems.children().remove();

                    StaffItems.append($("<option>").val("null").text("--- Select ---"));

                    $.each(data, function (i, record) {
                        StaffItems.append($("<option>").val(record.StaffId).text(record.DisplayName));
                    });

                    $('#StaffId').append(StaffItems);

                },
                aync: false
            });
        }
    }

    $('#StaffId').change(function () {

        $('#Capture').html("");

        if (parseInt($('#StaffId').val()) > 0) {
            CapturePhoto()
        }
    })

    function CapturePhoto() {
        debugger
        var StaffId = $('#StaffId').val();

        $('#imagemodal').show();

        $.ajax({
            url: '/AFrontOffice/GetPhotoIfCaptured',
            data: { StudentId: 0, StaffId: StaffId, Type: 0 },
            success: function (data) {
                $('#imagemodal').hide();

                $('#Capture').html(data);

                var src = $('#show').attr("src");

                canvas = null;
                image = new Image();
                image.onload = validateImage;
                image.src = src;

                document.getElementById('resetdata').value = src;
            },
            async: false,
        });
    }

    $(".select2").select2()

</script>

