@model List<AsteriskBrowserAL.Models.FeeRefundData>
@{
    var Status = "";
    ViewBag.Title = "Approve Fee Refund";
    //int Statuss = 0;
    int Level = 0;
    
    if(null != Model)
    {
        Level = Model.FirstOrDefault() != null ? Model.FirstOrDefault().Level : 0;
    }
    
    string strFiles = "";

}
<section class="content">

    <input style="display:none" id="Status" value="@Model" />
    @if (Model != null && Model.Count > 0)
    {
     

        <div class="table-header">
            Records Found (@Model.Count())
        </div>
        int nsno = 1;
        <div class="overflowscroll">

            <table class="table tbhover table-striped table-bordered dynamic-table">
                <thead>
                    <tr>
                        <th>
                            S.No.
                        </th>

                        <th>
                            @Html.DisplayName("Branch")
                        </th>
                        <th>
                            @Html.DisplayName("Student Name")
                        </th>

                        <th>
                            @Html.DisplayName("Class")
                        </th>

                        <th>
                            @Html.DisplayName("Parent Amount")
                        </th>

                        <th>
                            @Html.DisplayName("Branch Amount")
                        </th>

                        <th>
                            @Html.DisplayName("Branch Files")
                        </th>

                        <th>
                            @Html.DisplayName("Parent Files")
                        </th>

                        @if (Level > 1)
                        {
                            <th>
                                @Html.DisplayName("Privious Level Amount")
                            </th>

                            <th>
                                @Html.DisplayName("Privious Level Remarks")
                            </th>
                        }
                        <th>
                            @Html.DisplayName("Present Level Amount")
                        </th>

                        <th>
                            @Html.DisplayName("Status")
                        </th>
                        @*@if (Statuss == 0)
                    {*@
                        <th>
                            @Html.DisplayName("Request")
                        </th>
                        <th>
                            @Html.DisplayName("")
                        </th>
                        <th>
                            @Html.DisplayName("")
                        </th>
                        <th>
                            @Html.DisplayName("")
                        </th>
                        <th>
                            @Html.DisplayName("")
                        </th>
                        @*}*@
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                {
                        <tr>
                            <td>
                                @(nsno++)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.BranchName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.StudentName)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.ClassName)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ParentRequestedAmount)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.BranchRequestedAmount)
                            </td>

                            <td>
                                @if (null != item.UploadFiles)
                                {
                                    string Url = "";
                                    foreach (var file in item.UploadFiles)
                                    {
                                        @*http://docs.gms-erp.com/GMS/FeeRefund/140%20-2017-01-30%20-Main%20View.txt,Main%20View.txt.txt*@

                                Url = "http://docs.gms-erp.com/GMS/FeeRefund/" + file;

                                <a href="@Url" target="_blank" class="P2">@file</a> <br />
                                    }
                                }
                            </td>

                            <td>
                                @if (null != item.ParentUploadFiles)
                                {
                                    string Url = "";
                                    foreach (var file in item.ParentUploadFiles)
                                    {
                                        @*http://docs.gms-erp.com/GMS/FeeRefund/140%20-2017-01-30%20-Main%20View.txt,Main%20View.txt.txt*@

                                Url = "http://docs.gms-erp.com/GMS/FeeRefund/" + file;

                                <a href="@Url" target="_blank" class="P2">@file</a> <br />
                                    }
                                }
                            </td>

                            @if (Level > 1)
                            {
                                <td>
                                    @Html.DisplayFor(modelItem => item.PriviousLevelAmount)
                                </td>

                                <td>
                                    @Html.DisplayFor(modelItem => item.PriviousLevelRemarks)
                                </td>
                            }
                            <td>
                                @Html.DisplayFor(modelItem => item.PresentLevelAmount)
                            </td>

                            <td>
                                @if (item.StatusId == 0)
                                {
                                    Status = "Pending";
                                }
                                @if (item.StatusId == 1)
                                {
                                    Status = "Accepted " + (item.Remarks);
                                }
                                @if (item.StatusId == 2)
                                {
                                    Status = "Rejected " + (item.Remarks);
                                }
                                @if (item.StatusId == 3)
                                {
                                    Status = "Hold " + (item.Remarks);
                                }

                                @Html.DisplayName(Status)
                            </td>


                            @if (item.StatusId == 0)
                            {
                                <td>
                                    <a role="button" id="lnkApprove" onclick="ApproveBD(@item.FeeRefundId,@item.Level,@item.StudentId,@item.SubscriptionId,@item.StaffId,'1')">Approve</a>
                                </td>
                                <td>
                                    |
                                </td>
                                <td>
                                    <a role="button" id="lnkReject" onclick="ApproveBD(@item.FeeRefundId,@item.Level,@item.StudentId,@item.SubscriptionId,@item.StaffId,'2')">Reject</a>
                                </td>
                                <td>
                                    |
                                </td>
                                <td>
                                    <a role="button" id="lnkHold" onclick="ApproveBD(@item.FeeRefundId,@item.Level,@item.StudentId,@item.SubscriptionId,@item.StaffId,'3')">Hold</a>
                                </td>
                            }
                        </tr>
                    }
                </tbody>
            </table>
        </div>

    }
    else
    {
        <span style="color: red;"><b>Data not available</b></span>
        @*<div class="hr hr-18 dotted hr-double"></div>

            <div class="table-header">
                Records Found (0)
            </div>*@
    }

</section>
@*@Html.Action("DataTableScripts", "Base")*@
