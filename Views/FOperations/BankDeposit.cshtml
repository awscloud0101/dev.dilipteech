@model AsteriskBrowserAL.Models.BankDepositViewModel
@{
    ViewBag.Title = "Bank Deposit";
}

@section BreadCrumb{

    <ul class="breadcrumb">
        <li>
            <i class="fa fa-money"></i>
            Finance
        </li>
        <li>
            <i class="fa fa-gears"></i>
            Operations
        </li>
        <li class="active">Bank Deposit</li>
    </ul><!-- /.breadcrumb -->
}



@Html.Action("DatePickerScripts", "Base")

<!--Main Content-->
<section class="content">



    @using (Html.BeginForm())
    {
        <div class="row">
            <div class="col-xs-12">
                <span style="color:red;font-weight:bold" id="Validation"></span>
                <div class="table-header">

                  
                        Bank Deposit
                  

                  

                        <div class="inline action-buttons" style="float:right;">
                            <a class="btn btn-info btn-minier P2" id="btnNew" name="New"><i class="fa fa-plus-circle  P2" onclick="RedirectToNew()"> | Add</i></a>
                            <a><span class="btn btn-info btn-minier P2" id="btnViewData">View Data</span></a>



                            @*<button class="fa fa-plus-circle bigger-150 pull-right" id="Save" style="color:#a82682 ;" type="button" onclick="RedirectToNew()"></button>*@
                        </div>

                  

                </div><!-- /.box-header -->
                <div class="widget-box">



                    <div class="widget-body">

                        <div class="widget-main">

                            <div class="row">
                                <div class="col-xs-6">
                                    <div class="col-xs-4">
                                        <label for="form-field-1">From Date</label>
                                    </div>
                                    <div class="col-xs-6">
                                        <div id="datepicker" class="input-group date" data-date-format="dd/mm/yyyy">
                                            <input class="form-control" type="text" id="FromDate" name="FromDate" value="@Model.FromDate.ToShortDateString()" autocomplete="off" placeholder="Select Date" required="required" title="Please select the date" />
                                            <span class="input-group-addon"><i class="ace-icon fa fa-calendar"></i></span>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-xs-6">
                                    <div class="col-xs-4">
                                        <label for="form-field-1">To Date</label>
                                    </div>
                                    <div class="col-xs-6">
                                        <div id="datepicker" class="input-group date" data-date-format="dd/mm/yyyy">
                                            <input class="form-control" type="text" id="ToDate" name="ToDate" autocomplete="off" value="@Model.ToDate.ToShortDateString()" placeholder="Select Date" required="required" title="Please select the date" />
                                            <span class="input-group-addon"><i class="ace-icon fa fa-calendar"></i></span>
                                        </div>


                                    </div>

                                </div>
                            </div>

                        </div>

                    </div>

                </div>
                <div id="PVbankDepoist">
                </div>
            </div>
        </div>
    }

</section>

<script type="text/javascript">

    function ONLOADDATA() {
        PopulateBankDeposits();
    }

    window.onload = ONLOADDATA();

    $('#CboDivision').change(function () {
        var DivisionId = $('#CboDivision').val();

        if (DivisionId != 0) {
            $.ajax({
                url: '/Common/GetBranchesByDivisionId',
                data: { DivisionId: DivisionId },
                success: function (data) {
                    var BranchItems = $('#CboBranch');

                    BranchItems.children().remove();

                    BranchItems.append($("<option>").val("null").text("--- Select ---"));

                    $.each(data, function (i, record) {
                        BranchItems.append($("<option>").val(record.SubscriptionId).text(record.Institute));
                    });

                    $('#CboBranch').append(BranchItems);
                },
                aync: false
            });
        }
        else {
            var BranchItems = $('#CboBranch');
            BranchItems.children().remove();
            BranchItems.append($("<option>").val(0).text(""));

            var ClassItems = $('#CboClassNumber');
            ClassItems.children().remove();
            ClassItems.append($("<option>").val(0).text(""));

        }
    });

    $('#btnViewData').click(function () {
        var FromDate = $('#FromDate').val();
        var TOdate = $('#ToDate').val();

        var isValid = true;
        var Message = "Please fill the mandatory fields :  ";

        if (FromDate == "") {
            Message += "From Date";
            isValid = false;
        }

        if (TOdate == "") {
            if (!isValid)
                Message += ",";

            Message += " To Date";
            isValid = false;
        }


        if (!isValid) {
            document.getElementById("Validation").innerHTML = Message;
            return;
        }

        PopulateBankDeposits();
    });

    function PopulateBankDeposits() {
        $.ajax
            ({
                error: function (jqXHR, textStatus, errorThrown) {
                    alert(errorThrown);
                    $('#imagemodal').hide();
                },

                url: '/FOperations/PopulateBankDepositData/',
                data: { dtFromdate: $('#FromDate').val(), dtToDate: $('#ToDate').val() },
                beforeSend: function () {
                    $('#imagemodal').show();
                },
                success: function (data) {
                    $('#PVbankDepoist').html(data);
                }


            }).done(function () {
                $('#imagemodal').hide();
            });
    }

    $("#Date").focus(function () {
        document.getElementById("Error").innerHTML = ""
    })

    function RedirectToNew() {

        var FromDate = $('#FromDate').val();
        var TOdate = $('#ToDate').val();

        window.location.href = '/FOperations/BankDepositC?FromDate=' + FromDate + '&ToDate=' + TOdate;
    }

</script>

