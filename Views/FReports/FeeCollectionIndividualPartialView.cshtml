
@model AsteriskBrowserAL.Models.DaysheetDataViewModel
@using PagedList.Mvc;
@{
    Layout = null;
}

@if (null != Model)
{
   

    if (null != Model.LstDaySheetViewModel)
    {
        int nsno = 1;

        <div class="table-header">
            Records Found (@Model.LstDaySheetViewModel.Count())
            <div style="float:right">
                <button type="submit" class="btncustom" id="btnExport">
                    Download
                </button>
            </div>
        </div>
        <input type="hidden" id="bIsCentral" value="@Model.IsCentral" />
            if (Model.LstDaySheetViewModel.Count > 0)
            {
            <div class=" table-responsive no-padding">
                <table id="tbFeeCollectionIndvidual" class="table tbhover table-striped table-bordered dynamic-table">
                    <thead>
                        <tr>
                            <th>
                                S.No.
                            </th>

                            @if (@Model.IsCentral)
                            {
                            <th style="min-width:160px">
                                @Html.DisplayName("Division Name")
                            </th>

                            <th style="min-width:139px">
                                @Html.DisplayName("Branch Name")
                            </th>    }

                            <th style="min-width:120Px">
                                @Html.DisplayName("Academic Year")
                            </th>

                            <th style="min-width:120Px">
                                @Html.DisplayName("Payment Date")
                            </th>
                            <th style="min-width:90Px">
                                @Html.DisplayName("Time")
                            </th>
                            <th style="min-width:250Px">
                                @Html.DisplayName("Student Name")
                            </th>
                            <th class="Text140Left">
                                @Html.DisplayName("Admission No")
                            </th>
                            <th class="Text140Left">
                                @Html.DisplayName("Legacy Number")
                            </th>
                            <th style="min-width:112Px">
                                @Html.DisplayName("Class")
                            </th>

                            <th style="min-width:112Px">
                                @Html.DisplayName("Section")
                            </th>

                            <th class="Text160Left">
                                @Html.DisplayName("Fee Account Type")
                            </th>
                            <th style="min-width:160Px">
                                @Html.DisplayName("ERP Receipt No")
                            </th>
                            <th style="min-width:106Px">
                                @Html.DisplayName("Template No")
                            </th>
                            <th style="min-width:160Px">
                                @Html.DisplayName("Manual Receipt No")
                            </th>

                            @if (Model.Individual == true)
                            {
                            <th style="min-width:188Px">
                                @Html.DisplayName("Particular Name")
                            </th>    }

                            <th style="min-width:120Px">
                                @Html.DisplayName("Debit Amount")
                            </th>
                            <th style="min-width:125Px;">
                                @Html.DisplayName("Payment Mode")
                            </th>
                            <th class="Text160Left">
                                @Html.DisplayName("Transaction Details")
                            </th>
                            <th class="Text160Left">
                                @Html.DisplayName("Receipt Status")
                            </th>

                            <th class="Text160Left">
                                @Html.DisplayName("QRCode Status")
                            </th>
                            <th class="Text160Left">
                                @Html.DisplayName("Audit by")
                            </th>
                            <th class="Text160Left">
                                @Html.DisplayName("IsMobile")
                            </th>

                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var item in Model.LstPagedDaysheetViewModel)
                        {
                        <tr style=@item.Color>
                            <td>
                                @(nsno++)
                            </td>

                            @if (Model.IsCentral)
                                {
                        <td>
                            @Html.DisplayFor(modelItem => item.DivisionName)
                        </td>

                        <td>
                            @Html.DisplayFor(modelItem => item.BranchName)
                        </td>    }

                            <td style="min-width:120Px">
                                @Html.DisplayFor(modelItem => item.AcademicYear)
                            </td>

                            <td>
                                @item.TransactionDate.Value.ToString("dd-MMM-yyyy")
                            </td>

                            <td style="min-width:120Px">
                                @Html.DisplayFor(modelItem => item.TransactionDateDisplay)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.Description)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.AdmissionNumber)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.LegacyNumber)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ClassName)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.SectionName)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.Category)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ReceiptNumber)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.DisplayTemplateNumber)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.ManualReceiptNumber)
                            </td>

                            @if (Model.Individual == true)
                                {
                        <td>
                            @Html.DisplayFor(modelItem => item.Particulars)
                        </td>    }

                            <td style="text-align:right;padding:-30Px">
                                @Html.DisplayFor(modelItem => item.Receipts)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.PaymentType)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.TransactionDetails)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Status)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.QRCodeStatus)
                            </td>

                            <td>
                                @Html.DisplayFor(modelItem => item.Auditby)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.IsMobile)
                            </td>
                        </tr>  }
                    </tbody>
                </table>
                @Html.Action("DataTableScripts", "Base", new { IsPage = false, allowScroll = true, strHeight = "400px" })


            </div>

            @*<div id='myPager' style="text-align: right; margin-right : 20px">

                Page @(Model.LstPagedDaysheetViewModel.PageNumber)  of @Model.LstPagedDaysheetViewModel.PageCount

                @Html.PagedListPager(Model.LstPagedDaysheetViewModel, page => Url.Action("GetFeeCollectionDataAsperPage", new { page, nTypeId = ViewBag.TypeId, bIsIndividual = ViewBag.IsIndividual }))
            </div>*@




            }
            else
            {   
            <span style="color:red;font-weight:bold;"> Transactions are not done yet</span>
            }




            if (!Model.IsCentral)
            {
            <div>
                <table class="table table-striped table-bordered table-hover">
                    <tbody>
                        <tr>
                            <td>
                                Todays' Cash Collection
                            </td>
                            <td style="text-align:right">
                                @Model.TotalCashAmount
                            </td>
                            <td>
                                Todays' Cheque Collection
                            </td>
                            <td style="text-align:right">
                                @Model.TotalChequeAmount
                            </td>
                        </tr>

                        <tr>
                            <td>
                                Cancelled receipts(Cash)
                            </td>

                            <td style="text-align:right">
                                @Model.CancelledCashAmount
                            </td>
                            <td>
                                Cancelled receipts(Cheque)

                            <td style="text-align:right">
                                @Model.CancelledChequeAmount
                            </td>

                        </tr>

                        <tr>
                            <td>
                                Cash Grand Total
                            </td>

                            <td style="text-align:right">
                                @Model.TotalNetAmount
                            </td>
                            <td>
                                Cheques Grand Total
                            </td>
                            <td style="text-align:right">
                                @Model.TotalNetChequeAmount
                            </td>

                        </tr>

                        <tr>
                            <td>
                                Swipe Card Collection
                            </td>

                            <td style="text-align:right">
                                @Model.SwipeAmount
                            </td>

                            <td>
                                Cancelled receipts(Swipe)
                            </td>

                            <td style="text-align:right">
                                @Model.CancelledSwipeAmount
                            </td>
                        </tr>

                        <tr>
                            <td>
                                Online Collection
                            </td>

                            <td style="text-align:right">
                                @Model.OnlineAmount
                            </td>

                            <td>
                                Cancelled receipts(Online)
                            </td>

                            <td style="text-align:right">
                                @Model.CancelledOnlineAmount
                            </td>
                        </tr>

                        <tr>
                            <td>
                                Grand Total Collection
                            </td>

                            <td style="text-align:right">
                                @Model.GrandCollectionAmount
                            </td>

                            <td></td>

                            <td style="text-align:right"></td>

                        </tr>
                    </tbody>
                </table>


            </div><!-- /.box-header -->
            }
            else
            {
            <div class="well">
                <table>
                    <tr>
                        <td>
                            <h5 class="blue">Total Credit Amount : </h5>
                        </td>
                        <td>
                            <h5>
                                @Model.LstDaySheetViewModel.Sum(t => t.Receipts)
                            </h5>
                        </td>
                    </tr>
                </table>
            </div>
            }

            }
            }
            else
            {
            <span style="color:red;font-weight:bold;">Data not available to display</span>
            }
    
<br /><br /><br />

<script type="text/javascript">

    $('#myPager').on('click', 'a', function (e) {
        debugger
        e.preventDefault();
        $.ajax({
            url: this.href,
            type: 'GET',
            cache: false,
            success: function (result) {
                $('#ReportData').html('');
                $('#ReportData').html(result);
            }
        });
    });

</script>