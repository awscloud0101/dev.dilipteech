@model IEnumerable<AsteriskBrowserAL.Models.BiometricStaffAttendance>

    @{
        ViewBag.Title = "Modifications Report";
        int Nsno = 1;
        }

    @if (Model.Count() > 0)
    {
        <div class="row">
            <div class="col-xs-12">
                <div class="box">
                    <div class="box-header">
                        <div>
                            <input class="btn btn-primary" style="width:80px;" type="button" value="Print" onclick="PrintElem('#mydiv')" />
                        </div>
                    </div><!-- /.box-header -->

                    <div class="box-body table-responsive no-padding">
                        <table class="table table-hover">
                            <tbody>
                                <tr>
                                    <th>
                                       S.No.
                                    </th>
                                    <th>
                                        @Html.DisplayName("Employee Number")
                                    </th>
                                    <th>
                                        @Html.DisplayName("Staff Name")
                                    </th>
                                    <th>
                                        @Html.DisplayName("Duration")
                                    </th>
                                    <th>
                                        @Html.DisplayName("Modified Days")
                                    </th>
                                    <th>
                                        @Html.DisplayName("Modified By")
                                    </th>
                                </tr>
                                @foreach (var item in Model)
                                {
                                    <tr>
                                        <td>
                                            @(Nsno++)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.EmployeeNumber)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.StaffName)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.ModifiedTime)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.ModificationCount)
                                        </td>
                                        <td>
                                            @Html.DisplayFor(modelItem => item.ModifiedBy)
                                        </td>
                                    </tr>
                                }

                            </tbody>

                        </table>
                    </div>
                </div>
            </div>
        </div>    
}
else
{
    <span style="color:red;font-weight:bold;">Data not available to display</span>
}
  
<script type="text/javascript">

    //Printing data by opening popup
    function PrintElem(elem) {

        Popup($(elem).html());
    }

    function Popup(data) {
        var mywindow = window.open('', 'my div', 'height=300,width=600');
        mywindow.document.write('<p></p>');
        mywindow.document.write(data);
        mywindow.document.write('<p></p>');

        mywindow.document.close();
        mywindow.focus();

        mywindow.print();
        mywindow.close();
        return true;
    }
</script>
<body>
    <div id="mydiv" style="display:none">
        @if (Model.Count() > 0)
        {
            int nsno = 1;        
            <div class="row">
                <div class="col-xs-12">
                    <img class=" col-xs-11" id="avatar" width="50" height="43" src="@ViewBag.ImageData" style="margin-bottom:-1.5em;" />
                    <b style="font-weight:bold; margin-left:0.3em; font-size:20px; font-family:'Segoe UI'">@ViewBag.InstituteName</b>
                </div>
                <div style="margin-left:3.7em; font-family:'Segoe UI'"><b>@ViewBag.InstituteAddres</b></div>
                <br />

                <hr style="width:100%; margin-bottom:-0.5em" />
                <hr style="width:100%;" />
                <div align="left" style="font:12%; font-family:'Segoe UI'"><b>Date: @ViewBag.StartDate.ToString("dd - MMM - yyyy") To  @ViewBag.EndDate.ToString("dd - MMM - yyyy")&nbsp;&nbsp;&nbsp;Raos Central Office Attendance Modification Report</b></div>
                <hr style="width:100%;" />
                <hr style="width:100%; margin-top:-0.5em" />

                <div class="col-xs-12 box-body table-responsive">
                    <table class="table table-hover" rules="rows" cellpadding="9" style="width:657px; font-size:12px;">

                        <tbody>
                            <tr style="font-size:13px; font-weight:bold; text-align:left;">
                                <th>
                                   S.No.
                                </th>
                                <th>
                                    @Html.DisplayName("Employee Number")
                                </th>
                                <th>
                                    @Html.DisplayName("Staff Name")
                                </th>
                                <th>
                                    @Html.DisplayName("Duration")
                                </th>
                                <th>
                                    @Html.DisplayName("Modified Days")
                                </th>
                                <th>
                                    @Html.DisplayName("Modified By")
                                </th>
                            </tr>
                            @foreach (var item in Model)
                            {
                                <tr>
                                    <td>
                                        @(nsno++)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.EmployeeNumber)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.StaffName)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.ModifiedTime)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.ModificationCount)
                                    </td>
                                    <td>
                                        @Html.DisplayFor(modelItem => item.ModifiedBy)
                                    </td>
                                </tr>
                            }

                        </tbody>

                    </table>
                </div>
            </div>
        }
    </div>
</body>


